Description: Setup a hosted zone for DNS
AWSTemplateFormatVersion: 2010-09-09
Parameters:
  OwnerEmail:
    Description: 'Email address of the owner of this resource'
    Type: String
    AllowedPattern: '^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$'
    ConstraintDescription: 'Must be an acceptable email address syntax(i.e. joe.smith@sagebase.org)'
    Default: 'it@sagebase.org'
  DnsDomainName:
    Description: A fully qualified domain name (i.e. sagebionetworks.org)
    Type: String
Resources:
  HostedZone:
    Type: "AWS::Route53::HostedZone"
    Properties:
      HostedZoneConfig:
        Comment: !Sub "Hosted zone for ${DnsDomainName}"
      Name: !Join ["", [!Ref DnsDomainName, "."]]
      HostedZoneTags:
        -
          Key: "Name"
          Value: !Ref AWS::StackName
        -
          Key: "OwnerEmail"
          Value: !Ref OwnerEmail
Outputs:
  HostedZoneId:
    Value: !Ref HostedZone
    Export:
      Name: !Sub '${AWS::Region}-${AWS::StackName}-HostedZoneId'
  HostedZoneNameServers:
    Value: !Join
      - ','
      - !GetAtt HostedZone.NameServers
    Export:
      Name: !Sub '${AWS::Region}-${AWS::StackName}-HostedZoneNameServers'
